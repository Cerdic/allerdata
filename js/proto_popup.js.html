/* --------------------------------------------- POPUP -------------------------------------------- */
/* ux.IFrameComponent : link. http://extjs.com/forum/showthread.php?p=54322 */
/* ux.ManagedIframe : link. http://extjs.com/forum/showthread.php?t=16590 */

var dialog, dialog_avec_tab;

Ext.onReady(function(){
	
	dialog_avec_tab = new Ext.Window({
	    applyTo: 'tabpanel-win',
	    layout: 'fit',
	    width: 350,
	    height: 450,
	    minimizable: true,
	    closeAction: 'hide',
	    plain: true,
	    items: new Ext.TabPanel({
	        el: 'popup-dlg-tab',
	        autoTabs: true,
	        activeTab: 0,
	        deferredRender: false,
	        border: false
	    }),
	    buttons: [{
	        text: 'Fermer',
	        handler: function(){
							$("#iframe").attr('src','');
	            dialog_avec_tab.hide();
	        }
	    }]
	});
	dialog_avec_tab.on('minimize', function(){
	    dialog_avec_tab.toggleCollapse(false);
	});


	dialog = new Ext.Window({
	    applyTo: 'popup-win',
	    layout: 'fit',
	    width: 350,
	    height: 450,
	    minimizable: true,
	    closeAction: 'hide',
	    plain: true,
	    items: new Ext.BoxComponent({
	        applyTo: 'popup-dlg', 
	        autoTabs: true,
	        activeTab: 0,
	        deferredRender: false,
	        border: false
	    }),
	    buttons: [{
	        text: 'Fermer',
	        handler: function(){
							$("#iframe2").attr('src','');
	            dialog.hide();
	        }
	    }]
	});
	dialog.on('minimize', function(){
	    dialog.toggleCollapse(false);
	});
	
});

<?php
foreach (array(1,2,3,4,5) as $i) {
echo "
  jQuery('#info-s$i').click(function() {
    if (jQuery('#p$i').val()) {
      dialog.setTitle(jQuery('#prod_$i').val());
      var link = 'spip.php?page=popup_item&id_item=' + jQuery('#p$i').val();
      Ext.get('popup-iframe').dom.src = link;
      dialog.show(Ext.get('prod_$i'));
    }
    return false;
  })";
}
?>
